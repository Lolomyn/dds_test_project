{% extends 'base.html' %}
{% load rest_framework %}

{% block title %}Операции{% endblock %}


{% block content %}
    <form method="get" action="{% url 'dds_service:transaction' %}" class="p-3 border rounded mb-4">
        <div class="row g-3">
            <div class="col-md-4">
                <label for="status" class="form-label">Статус</label>
                <input type="text" class="form-control" id="status" name="status__name"
                       value="{{ request.GET.status__name }}" placeholder="Введите статус">
            </div>
            <div class="col-md-4">
                <label for="category" class="form-label">Категория</label>
                <input type="text" class="form-control" id="category" name="category__name"
                       placeholder="Введите категорию" value="{{ request.GET.category__name }}">
            </div>
            <div class='col-md-4'>
                <label for='sub_category' class='form-label'>Подкатегория</label>
                <input type='text' class='form-control' id='sub_category' name='subcategory__name'
                       value="{{ request.GET.subcategory__name }}" placeholder='Введите подкатегорию'>
            </div>
            <div class='col-md-4'>
                <label for='date_from' class='form-label'>Дата с</label>
                <input type='date' class='form-control' id='date_from' name='date_from'>
            </div>
            <div class='col-md-4'>
                <label for='date_to' class='form-label'>Дата по</label>
                <input type='date' class='form-control' id='date_to' name='date_to'>
            </div>
        </div>
        <div class='mt-3'>
            <button type='submit' class='btn btn-primary'>Фильтровать</button>
        </div>
    </form>

    <div class="row">
        <table class="table">
            <thead>
            <tr>
                <th scope="col">ID</th>
                <th scope="col">Дата создания</th>
                <th scope="col">Статус</th>
                <th scope="col">Тип</th>
                <th scope="col">Категория</th>
                <th scope="col">Подкатегория</th>
                <th scope="col">Сумма</th>
                <th scope="col">Комментарий</th>
                <th></th>
            </tr>
            </thead>

            {% for object in transactions %}
                <tbody class="align-text-top">
                <tr>
                    <th scope="row">{{ object.pk }}</th>
                    <td>{{ object.created_at }}</td>
                    <td>{{ object.status }}</td>
                    <td>{{ object.type }}</td>
                    <td>{{ object.category }}</td>
                    <td>{{ object.subcategory }}
                    <td>{{ object.amount }} руб.</td>
                    <td>{{ object.description|truncatechars:20 }}</td>
                    <td><a href="{% url 'dds_service:transaction-detail' object.pk %}"
                           class="card-link btn btn-outline-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                             class="bi bi-search" viewBox="0 0 16 16">
                            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
                        </svg>
                    </a></td>
                </tr>
                </tbody>
            {% endfor %}
        </table>
    </div>
{% endblock %}